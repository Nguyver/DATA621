---
title: "Critical Thinking Group 4 - HW3"
author: "Sreejaya, Suman, Vuthy"
date: "October 10, 2016"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo=FALSE)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80),tidy=TRUE)
```

```{r, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(car)
library(recommenderlab)
library(knitr)
library(PerformanceAnalytics)
```

## Overview

Dataset  
[Crime - Training data](https://github.com/Nguyver/DATA621-HW/blob/master/HW3/crime-training-data.csv)  
[Crime - Evaluation Data](https://github.com/Nguyver/DATA621-HW/blob/master/HW3/crime-evaluation-data.csv)

## Data Exploration

There are 466 observations, and 14 variables in the given training dataset. The below is a glimpse of the data.
```{r}
crime.trn  <- read.csv("https://raw.githubusercontent.com/Nguyver/DATA621-HW/master/HW3/crime-training-data.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)

crime.evl  <- read.csv("https://raw.githubusercontent.com/Nguyver/DATA621-HW/master/HW3/crime-evaluation-data.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)

glimpse(crime.trn)
```

Lets check the summary of the given dataset, as well as check for any NA values in the data set.
```{r}
summary(crime.trn)
```


There appears to be no missing values. Lets plot the correlation between the variables.

```{r, warning=FALSE, message=FALSE}
cor.matrix <- cor(crime.trn[,1:ncol(crime.trn)])
chart.Correlation(cor.matrix, histogram=TRUE, pch=19)
```

From the above correlation matrix , the target varaible seems to have correlation with 

  * zn    - proportion of residential land zoned for large lots 
  * indus - proportion of non-retail business acres per suburb 
  * nox   - nitrogen oxides concentration 
  * age   - proportion of owner-occupied units built prior to 1940 
  * dis   - weighted mean of distances to five Boston employment centers  
  * rad   - index of accessibility to radial highways 
  * tax   - full-value property-tax rate per $10,000 
  * lstat - lower status of the population 


## Data Preparation

Lets look at each of the predictor variable's data:

Find the average response rate, basically how many target 1's and 0's for each of the predictor's value, and then categorize the predictors accordingly:

### *zn* - proportion of residential land zoned for large lots

```{r}
#proportion of residential land zoned for large lots

#Lets look at the average response rate.
#gives %ges across rows , and rounded by 2 decimals.

kable(round(prop.table(table(crime.trn$zn, crime.trn$target), 1),2))
```

Here, we have the below categories for zn

0.37 :  0

0.38 : 20

0.78 : 22

1.0  : All others.

So, we left with these 4 categories. So, by definition, we need to make 3 dummy variables.

```{r, warning=FALSE, message=FALSE}
crime.trn.new <-  crime.trn %>%
                    mutate(zn1 = as.numeric(zn==0),
                           zn2 = as.numeric(zn==20),
                           zn3 = as.numeric(zn==22)) %>%
                    select(-zn)

#since we prepared the dummy variables needed, we do not need the zn any more here.
kable(head(crime.trn.new,15))
```

Similarly, let's proceed with others

### *indus* - proportion of residential land zoned for large lots

```{r, eval=FALSE}
#round(prop.table(table(crime.trn.new$indus, crime.trn.new$target), 1),2)
```


|Indus | Target    |
|------|-----------|
|2.95  | 1.00| 0.00|
|3.24  | 1.00| 0.00|
|3.33  | 1.00| 0.00|
|3.37  | 1.00| 0.00|
|3.41  | 1.00| 0.00|
|3.44  | 1.00| 0.00|
|3.64  | 1.00| 0.00|
|3.75  | 1.00| 0.00|
|3.78  | 1.00| 0.00|
|4     | 1.00| 0.00|
|4.05  | 1.00| 0.00|
|4.15  | 1.00| 0.00|
|4.39  | 1.00| 0.00|
|4.49  | 1.00| 0.00|
|4.86  | 1.00| 0.00|
|4.93  | 1.00| 0.00|
|4.95  | 1.00| 0.00|
|5.13  | 1.00| 0.00|
|5.19  | 1.00| 0.00|
|5.32  | 1.00| 0.00|
|5.64  | 1.00| 0.00|
|5.96  | 1.00| 0.00|
|6.06  | 1.00| 0.00|
|6.07  | 1.00| 0.00|
|6.09  | 1.00| 0.00|
|10.01 | 1.00| 0.00|
|10.81 | 1.00| 0.00|
|11.93 | 1.00| 0.00|
|12.83 | 1.00| 0.00|
|13.89 | 1.00| 0.00|
|13.92 | 1.00| 0.00|
|15.04 | 1.00| 0.00|
|6.41  | 1.00| 0.00|
|6.91  | 1.00| 0.00|
|7.07  | 1.00| 0.00|
|7.87  | 1.00| 0.00|
|25.65 | 1.00| 0.00|
|27.74 | 1.00| 0.00|
|------|-----|-----|
|7.38  | 0.67| 0.33|
|------|-----|-----|
|9.69  | 0.71| 0.29|
|10.59 | 0.70| 0.30|
|------|-----|-----|
|5.86  | 0.78| 0.22|
|6.96  | 0.80| 0.20|
|------|-----|-----|
|8.56  | 0.91| 0.09|
|------|-----|-----|
|9.9   | 0.18| 0.82|
|------|-----|-----|
|21.89 | 0.07| 0.93|
|------|-----|-----|
|18.1  | 0.00| 1.00|
|19.58 | 0.00| 1.00|
|8.14  | 0.00| 1.00|
|3.97  | 0.00| 1.00|
|6.2   | 0.00| 1.00|
|------|-----|-----|

We would need 7 dummy variables here:

```{r, warning=FALSE, message=FALSE}
crime.trn.new <-  crime.trn.new %>%
                    mutate(indus1 = as.numeric(indus %in% c(18.1, 19.58,8.14,3.97,6.2)),
                           indus2 = as.numeric(indus==21.89),
                           indus3 = as.numeric(indus==9.9),
                           indus4 = as.numeric(indus==8.56),
                           indus5 = as.numeric(indus %in% c(5.86, 6.96)),
                           indus6 = as.numeric(indus %in% c(9.69, 10.59)),
                           indus7 = as.numeric(indus==7.38)) %>%
                    select(-indus)

#since we prepared the dummy variables needed, we do not need the indus any more here.
kable(head(select(crime.trn.new, target, indus1, indus2, indus3, indus4, indus5, indus6, indus7),15))

```

### *nox*   - nitrogen oxides concentration 

```{r, eval=FALSE}
#kable(round(prop.table(table(crime.trn.new$nox, crime.trn.new$target), 1),2))
```

|nox    | Target    |
|-------|-----------|
|0.389  | 1.00| 0.00|
|0.392  | 1.00| 0.00|
|0.394  | 1.00| 0.00|
|0.398  | 1.00| 0.00|
|0.4    | 1.00| 0.00|
|0.401  | 1.00| 0.00|
|0.403  | 1.00| 0.00|
|0.404  | 1.00| 0.00|
|0.405  | 1.00| 0.00|
|0.409  | 1.00| 0.00|
|0.41   | 1.00| 0.00|
|0.411  | 1.00| 0.00|
|0.413  | 1.00| 0.00|
|0.415  | 1.00| 0.00|
|0.4161 | 1.00| 0.00|
|0.422  | 1.00| 0.00|
|0.426  | 1.00| 0.00|
|0.428  | 1.00| 0.00|
|0.429  | 1.00| 0.00|
|0.433  | 1.00| 0.00|
|0.437  | 1.00| 0.00|
|0.4379 | 1.00| 0.00|
|0.439  | 1.00| 0.00|
|0.442  | 1.00| 0.00|
|0.4429 | 1.00| 0.00|
|0.445  | 1.00| 0.00|
|0.447  | 1.00| 0.00|
|0.448  | 1.00| 0.00|
|0.449  | 1.00| 0.00|
|0.453  | 1.00| 0.00|
|0.458  | 1.00| 0.00|
|0.46   | 1.00| 0.00|
|0.469  | 1.00| 0.00|
|0.472  | 1.00| 0.00|
|0.484  | 1.00| 0.00|
|0.488  | 1.00| 0.00|
|0.499  | 1.00| 0.00|
|0.51   | 1.00| 0.00|
|0.515  | 1.00| 0.00|
|0.518  | 1.00| 0.00|
|0.524  | 1.00| 0.00|
|0.547  | 1.00| 0.00|
|0.55   | 1.00| 0.00|
|0.573  | 1.00| 0.00|
|0.581  | 1.00| 0.00|
|0.609  | 1.00| 0.00|
|-------------------|
|0.52   | 0.91| 0.09|
|-------------------|
|0.493  | 0.67| 0.33|
|0.585  | 0.71| 0.29|
|-------------------|
|0.431  | 0.78| 0.22|
|0.489  | 0.79| 0.21|
|-------------------|
|0.464  | 0.88| 0.12|
|-------------------|
|0.544  | 0.18| 0.82|
|-------------------|
|0.624  | 0.07| 0.93|
|0.538  | 0.05| 0.95|
|-------------------|
|0.504  | 0.00| 1.00|
|0.507  | 0.00| 1.00|
|0.532  | 0.00| 1.00|
|0.575  | 0.00| 1.00|
|0.58   | 0.00| 1.00|
|0.583  | 0.00| 1.00|
|0.584  | 0.00| 1.00|
|0.597  | 0.00| 1.00|
|0.605  | 0.00| 1.00|
|0.614  | 0.00| 1.00|
|0.631  | 0.00| 1.00|
|0.647  | 0.00| 1.00|
|0.655  | 0.00| 1.00|
|0.659  | 0.00| 1.00|
|0.668  | 0.00| 1.00|
|0.671  | 0.00| 1.00|
|0.679  | 0.00| 1.00|
|0.693  | 0.00| 1.00|
|0.7    | 0.00| 1.00|
|0.713  | 0.00| 1.00|
|0.718  | 0.00| 1.00|
|0.74   | 0.00| 1.00|
|0.77   | 0.00| 1.00|
|0.871  | 0.00| 1.00|
|-------|-----|-----|

```{r, warning=FALSE, message=FALSE}
crime.trn.new <-  crime.trn.new %>%
                    mutate(nox1 = as.numeric(nox %in% c(0.504,0.507,0.532,0.575,0.58,0.583,0.584,0.597,0.605,0.614,0.631,0.647,0.655,0.659,0.668,0.671,0.679,0.693,0.7,0.713,0.718,0.74,0.77,0.871)),
                           nox2 = as.numeric(nox %in% c(0.624,0.538 )),
                           nox3 = as.numeric(nox==0.544),
                           nox4 = as.numeric(nox==0.464),
                           nox5 = as.numeric(nox %in% c(0.431, 0.489)),
                           nox6 = as.numeric(nox %in% c(0.493, 0.585)),
                           nox7 = as.numeric(nox==0.52)) %>%
                    select(-nox)

#since we prepared the dummy variables needed, we do not need the nox any more here.
kable(head(select(crime.trn.new, target, nox1, nox2, nox3, nox4, nox5, nox6, nox7),15))

```

Similary we need to re-categorize the other correlated variables...

## Build Models

## Select Models

## Predictions

## Appendix