---
title: "Critical Thinking Group 4 - HW5 - Wine"
author: "Sreejaya, Suman, Vuthy"
date: "November 15, 2016"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo=FALSE)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80),tidy=TRUE)
options(scipen=999)
```


```{r, load libraries}
library(dplyr)
library(psych)
 # library(ggplot2)
 # library(gridExtra)
 # library(car)
 # library(recommenderlab)
 # library(knitr)
 # library(caret)
 # library(pROC)
```

# Overview
The objective of this assignment is to predict the number of cases of wine that will be sold based on the properties of the wine. A count regression model will be used to predict wine sales.

**Dataset**  
[Wine - Training data](https://raw.githubusercontent.com/Nguyver/DATA621-HW/master/HW5/wine-training-data.csv)  
[Wine - Evaluation Data](https://raw.githubusercontent.com/Nguyver/DATA621-HW/master/HW5/wine-evaluation-data.csv)  

## Data Exploration

```{r read data}
wine.trn  <- read.csv("https://raw.githubusercontent.com/Nguyver/DATA621-HW/master/HW5/wine-training-data.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)

wine.evl  <- read.csv("https://raw.githubusercontent.com/Nguyver/DATA621-HW/master/HW5/wine-evaluation-data.csv", header=TRUE, sep=",", stringsAsFactors = FALSE)
```

```{r}
summary(wine.trn)
glimpse(wine.trn)
```

### Missing Data

Eight of the variables have missing data.

```{r eval=FALSE}
na_count <-data.frame(sapply(wine.trn, function(y) sum(length(which(is.na(y))))))

na_count$prc <- sapply(na_count, function(y) sum(length(which(is.na(y)))))

#Table Generated manually. Will try to generate metrics automatically later on
```

| Variable Name      | Number | % NA  |
|--------------------|--------|-------|
| ResidualSugar      | 616    | 4.8%  |
| Chlorides          | 638    | 4.9%  |
| FreeSulfurDioxide  | 647    | 5.0%  |
| TotalSulfurDioxide | 682    | 5.3%  |
| pH                 | 395    | 3.0%  |
| Sulphates          | 1210   | 9.4%  |
| Alcohol            | 653    | 5.1%  |
| STARS              | 3359   | 26.2% |
  

```{r}

#1. Remove INDEX variable
names(wine.trn1)
wine.trn1 <- wine.trn[,-1]

#2.  Let us see WINE Data Histograms
dev.off()
layout(matrix(1:15,3,5,byrow=TRUE))
#par(mfrow=c(3,5))
par(mar=c(2,1,2,1))
for (i in 1:ncol(wine.trn1))  hist(wine.trn1[,i],main = names(wine.trn1)[i])

#3.  now WINE Data Boxplot

layout(matrix(1:15,3,5,byrow=TRUE))
#par(mfrow=c(3,5))
par(mar=c(2,1,2,1))
for (i in 1:ncol(wine.trn1))  boxplot(wine.trn1[,i],main = names(wine.trn1)[i])

#4.
library(PerformanceAnalytics)
cor.matrix <- cor(wine.trn[,1:ncol(wine.trn)])
chart.Correlation(cor.matrix, histogram=TRUE, pch=19)

#5.
#Replace na's with '0' in Alcohol (assuming non alcoholic wine)

wine.trn$Alcohol[is.na(wine.trn$Alcohol)] <- 0
#wine.trn$Alcohol

#6. Convert Stars to Dummy variables 

 library(dummies)
 STARS <- wine.trn1
 STARS <- cbind(STARS, dummy(STARS$STARS, sep = "_"))
 head(STARS)
 wine.trn1 <- STARS
 wine.trn1 <- wine.trn1[,-wine.trn1$STARS]
 wine.trn1 <- subset(wine.trn1, select = -c(STARS) )
 head(wine.trn1)
```


## Data Preparation

## Build  Models

## Model Selection

## Appendix

```{r eval=FALSE, echo=TRUE, options(width = 80)}

```
